timestamp,scope,file,action,user_intent,mm_thought,implementation,ai_tips,ref
2025-11-27T12:20,spoke,Services/HotKeyService.swift,fix,快捷键处理一个后失效,CGEvent tap 可能被系统超时禁用,添加 tapDisabledByTimeout 处理+自动重启+resetState(),检查 isRecording/isToggleSession 状态重置,HotKeyService#handleEvent
2025-11-27T12:26,spoke,Services/RecordingController.swift,update,LLM 动画太晚出现像卡壳,录音结束后应立即显示 thinking 状态,stopRecordingSession 根据 llmPipeline.shouldProcess 选择状态,若启用 LLM 则跳过 processing 直接 thinking,RecordingController#stopRecordingSession
2025-11-27T12:30,spoke,UI/HUD/FloatingCapsuleView.swift,fix,流光效果不显示,AIGlowView 被毛玻璃层遮挡+clipShape 裁剪,改用 RunningLightBorder 作为 overlay 放在 clipShape 后,边框动画用 AngularGradient+rotation,FloatingCapsuleView#RunningLightBorder
2025-11-27T12:46,spoke,UI/HUD/FloatingCapsuleView.swift,update,转圈样式改成彩色点,参考 Apple Intelligence 风格,StatusIndicator 改成 6 个彩色点旋转,用 ZStack+ForEach+offset+rotationEffect,FloatingCapsuleView#StatusIndicator
2025-11-27T12:46,spoke,Services/FloatingHUDManager.swift,update,打钩到消失太慢,用户体验优化,scheduleHide 从 1.5s 改为 0.75s,成功状态不需要停留太久,FloatingHUDManager#complete
2025-11-27T12:10,spoke,Core/LLM/KeychainService.swift,update,Keychain 每次启动都要授权,开发阶段签名变化导致,添加内存缓存减少 Keychain 访问次数,load 时先查缓存再访问 Keychain,KeychainService#cache
2025-11-27T13:40,spoke,docs/roadmap.md,update,剪贴板历史作为 LLM 上下文,替代当前剪贴板改为历史+用户可选,roadmap 添加 Clipboard History 功能规划,底层先存储再实验效果;过滤敏感信息;限制单条长度,roadmap.md#Context-Awareness
2025-11-27T13:50,spoke,Services/ClipboardHistoryService.swift,create,实现剪贴板历史服务,监听变化+保存历史+过滤敏感+持久化,ClipboardHistoryService 完整实现,检查间隔1s;单条500字符;JSON持久化,ClipboardHistoryService.swift
2025-11-27T13:50,spoke,Core/LLM/LLMPipeline.swift,update,集成剪贴板历史,使用历史替代单条剪贴板,buildPrompt 使用 clipboardHistory.formatForPrompt(),限制20条历史作为上下文,LLMPipeline.swift#buildPrompt
2025-11-27T13:50,spoke,UI/Settings/SettingsView.swift,update,更新UI文案,剪贴板内容->剪贴板历史,修改设置项标题和描述,保持开关逻辑不变,SettingsView.swift#上下文选项
2025-11-27T14:07,spoke,Core/LLM/LLMSettings.swift,update,改进 System Prompt,让 LLM 主动利用剪贴板历史修正术语,重写 defaultSystemPrompt 明确指导修正规则,关键：明确告诉 LLM 用剪贴板历史修正听错的词,LLMSettings.swift#defaultSystemPrompt
2025-11-27T14:07,spoke,docs/roadmap.md,update,添加多模态音频功能规划,支持 Gemini/GPT-4o 直接听音频,roadmap 新增 Multimodal Audio 功能,检测 Provider 能力+可选传送音频+一步到位转录,roadmap.md#Multimodal-Audio
2025-11-27T15:10,spoke,Core/LLM/LLMSettings.swift,update,Prompt 驼峰处理太激进把中文也改了,需要保守策略+明确区分中英文,重写 defaultSystemPrompt 明确只对英文词消歧义;添加 v1~v4 迁移逻辑,Prompt 要给具体例子说明中文不变;迁移检测用 contains 匹配旧版特征,LLMSettings.swift#defaultSystemPrompt
2025-11-27T15:10,spoke,Services/ClipboardHistoryService.swift,update,调试日志污染剪贴板历史,过滤系统日志+构建日志,shouldIgnore 过滤 DEBUG/LLM PROMPT/Building 等关键词;loadHistory 时也清洗旧数据,过滤项目名 SpokenAnyWhere 可能误杀合法复制,ClipboardHistoryService.swift#shouldIgnore
2025-11-27T18:45,spoke,Core/LLM/LLMSettings.swift,update,解决 Keychain 重复弹窗问题,统一存储+一次性迁移+移除回退逻辑,合并 Legacy API Keys 到统一存储;OpenAICompatibleProvider 移除 Keychain 访问;hasConsolidatedAPIKeys 标记,LLMSettings.swift#consolidateLegacyAPIKeys
2025-11-27T22:57,spoke,Services/HistoryManager.swift;AudioPlayerService.swift,create,实现历史记录管理器,录音持久化+音频回放+重处理+自动清理,HistoryManager 管理 SwiftData+音频文件;AudioPlayerService 播放历史录音;UI 日期分组+透明按钮,SwiftData 需要在 AppDelegate 配置 ModelContext;cleanupTempFile 改为 saveRecording,HistoryManager.swift#saveRecording
2025-11-28T00:30,spoke,Core/QuickAsk/*;UI/HUD/QuickAsk*;Services/QuickAskService.swift,create,实现 Quick Ask 功能,快速提问需要独立 HUD+输入框+回答窗口,创建完整 Quick Ask 模块: QuickAskState/InputView/CapsuleView/Service/AnswerPanelView,Quick Ask 需要独立 Panel(canBecomeKey=true)才能接收键盘;ESC 用 cancelOperation 处理,QuickAskService.swift
2025-11-28T00:35,spoke,Services/HotKeyService.swift;AppSettings.swift,update,注册 Quick Ask 快捷键,独立快捷键触发 Quick Ask,添加 quickAskKeyCode/Modifiers 配置;handleQuickAskKeyDown 处理;设置界面支持自定义,默认⌥T;checkModifiersMatch 需要 target 参数区分两套快捷键,HotKeyService.swift#handleQuickAskKeyDown
2025-11-28T00:45,spoke,UI/HUD/FloatingPanel.swift,update,Quick Ask 窗口无法输入,FloatingPanel canBecomeKey=false 导致,创建 QuickAskPanel(canBecomeKey=true)+cancelOperation 处理 ESC+makeKey() 激活焦点,非激活窗口用 NSPanel nonactivatingPanel;需要键盘的用 canBecomeKey=true,FloatingPanel.swift#QuickAskPanel
2025-11-28T00:49,spoke,Core/LLM/KeychainService.swift,update,每次启动都要输入 Keychain 密码,开发阶段签名不一致,添加 useSimpleStorage 开关: true=UserDefaults / false=Keychain,发布前改回 false;测试模式数据存 debug.apikey.* 前缀,KeychainService.swift#useSimpleStorage
2025-11-28T00:53,spoke,Services/RecordingController.swift;QuickAskService.swift,fix,Quick Ask 后录音无波形,Quick Ask 覆盖了 audioService 回调且未恢复,startRecordingSession 重新 setupAudioCallbacks;cancelSession/sendQuestion 调用 resetQuickAskState,共享单例服务的回调会互相覆盖;每次使用前要重新设置,RecordingController.swift#startRecordingSession
2025-11-28T01:00,spoke,UI/HUD/QuickAskInputView.swift,update,输入框支持 Shift+Enter 换行+粘贴图片+拖拽蒙版,TextField 不支持多行和自定义键盘,创建 QuickAskNSTextView(NSTextView 子类): keyDown 处理 Shift+Enter/Enter; paste 支持图片; 拖拽显示 Drop files here 蒙版,NSTextView 需要子类化才能自定义键盘行为;剪贴板图片用 readObjects forClasses NSImage,QuickAskInputView.swift#QuickAskNSTextView
2025-11-28T01:20,spoke,UI/HUD/QuickAskCapsuleView.swift;QuickAskInputView.swift,update,扩大 Quick Ask 拖拽区域至全屏,原拖拽区域仅限 InputView 且蒙版太小,将 onDrop 和蒙版移至 QuickAskCapsuleView 最外层 ZStack;使用 GeometryReader 确保蒙版覆盖整个区域;移除 QuickAskInputView 的拖拽逻辑,拖拽事件应在最顶层容器处理以获得最大响应区域,QuickAskCapsuleView.swift#dropOverlay
2025-11-28T01:30,spoke,UI/HUD/QuickAskInputView.swift,fix,文件拖入输入框变成路径文本,NSTextView 默认接管拖拽事件导致 SwiftUI onDrop 不触发,QuickAskNSTextView unregisterDraggedTypes() 禁止接收拖拽,原生视图嵌套 SwiftUI 时需主动关闭原生拖拽处理,QuickAskInputView.swift#unregisterDraggedTypes
2025-11-28T01:35,spoke,UI/HUD/QuickAskInputView.swift,fix,清理未使用变量警告,isCommandPressed 初始化未被使用,移除未使用的变量声明,保持代码整洁,QuickAskInputView.swift#keyDown
2025-11-28T01:45,spoke,UI/HUD/QuickAskInputView.swift,update,优化附件缩略图样式,.file 类型图标太小且样式单一,重构 AttachmentThumbnail 使用 NSWorkspace 获取大图标+扩展名角标;统一 52x52 尺寸,.file 用 ZStack 组合背景+icon+角标;图片保持 fill 模式,QuickAskInputView.swift#AttachmentThumbnail
2025-11-28T01:50,spoke,UI/HUD/QuickAskCapsuleView.swift;QuickAskInputView.swift,fix,拖拽区域不完整+图片错位,NSTextView 层级高拦截事件;附件区域超出边界,用 Color.clear overlay 包裹 onDrop 覆盖整个区域;附件区域加 clipped() 和 padding,overlay+contentShape 可在原生视图之上响应拖拽;clipped 防止超出边界,QuickAskCapsuleView.swift#overlay
2025-11-28T02:00,spoke,UI/HUD/QuickAskCapsuleView.swift,fix,拖拽时 HUD 位置跳动,ZStack 条件渲染 dropOverlay 会改变布局计算,将 dropOverlay 移至 .overlay{} 内而非 ZStack 条件渲染,.overlay 不参与布局计算只叠加显示,QuickAskCapsuleView.swift#overlay
2025-11-28T02:05,spoke,Core/QuickAsk/QuickAskState.swift;UI/HUD/QuickAskInputView.swift,perf,图片附件渲染卡顿,每次渲染都处理大图,异步生成缩略图: addImage 先加占位再后台 makeThumbnail; AttachmentThumbnail 显示 thumbnail 而非原图,图片附件存 (原图+缩略图+ID); 缩略图最大 104x104,QuickAskState.swift#makeThumbnail
2025-11-28T02:15,spoke,Core/QuickAsk/QuickAskState.swift;UI/HUD/QuickAskInputView.swift,update,视频缩略图+剪贴板截图+分辨率,MP4 需要预览图;截图粘贴不工作;分辨率太低,AVAssetImageGenerator 提取视频帧;粘贴检测优先 tiff/png 数据;分辨率改为 256,视频缩略图用 AVFoundation;macOS 截图格式是 tiff;isVideo 用 UTType 判断,QuickAskState.swift#makeVideoThumbnail
2025-11-28T02:25,spoke,UI/HUD/QuickAskInputView.swift,fix,⌘V 粘贴截图不工作,NSTextView 未收到 ⌘V 快捷键,重写 performKeyEquivalent 捕获 ⌘V/C/X/A 并手动调用对应方法,NSPanel 里的 NSTextView 需要手动处理 performKeyEquivalent,QuickAskInputView.swift#performKeyEquivalent
2025-11-28T02:35,spoke,UI/HUD/QuickAskInputView.swift,update,输入框动态增高+滚动,内容多时无法滚动,开启 hasVerticalScroller; scrollerStyle=overlay; maxHeight 改为 200,NSScrollView 需要 hasVerticalScroller=true 才能滚动,QuickAskInputView.swift#makeNSView
2025-11-28T02:40,spoke,UI/HUD/HUDTheme.swift;*CapsuleView.swift;QuickAskInputView.swift,create,全局 HUD 文字颜色统一,文字颜色硬编码分散各处,创建 HUDTheme.swift 集中管理: textPrimary=0.9 / textSecondary=0.7 / textPlaceholder=0.4; 所有 HUD 文件使用 HUDTheme,颜色常量集中管理便于全局调整,HUDTheme.swift
2025-11-28T02:50,spoke,UI/HUD/QuickAskInputView.swift;QuickAskCapsuleView.swift,fix,输入框无法鼠标选择文字+触控板滚动,透明 Color.clear overlay 拦截了所有鼠标事件,移除透明 overlay 层; onDrop 直接绑定在主视图上; NSTextView 添加 isSelectable/isEditable,Color.clear + contentShape 会拦截所有点击事件;onDrop 可以直接绑定不需要透明层,QuickAskCapsuleView.swift#onDrop
2025-11-28T03:00,spoke,UI/QuickAsk/AnswerPanelView.swift,update,简化对话面板 UI,去掉多余按钮和交通灯,toolbar: 关闭按钮+新对话同一行; inputArea: 移除附件/思考/联网/共享按钮; 输入框改为 RoundedRectangle(24) 悬浮样式,简洁的对话 UI 只需要核心交互,AnswerPanelView.swift#inputArea
2025-11-28T03:10,spoke,UI/QuickAsk/AnswerPanelView.swift,fix,对话面板崩溃+磨砂圆角,NSWindow borderless 导致崩溃,改用 NSPanel + borderless + nonactivatingPanel; 视图 clipShape 圆角; VisualEffectBackground 磨砂,NSWindow borderless 不稳定;用 NSPanel 更安全;磨砂透明用 VisualEffectBackground,AnswerPanelView.swift#createWindowIfNeeded
2025-11-28T03:20,spoke,Services/HotKeyService.swift;UI/QuickAsk/AnswerPanelView.swift,fix,快捷键误触+对话框美化,复杂快捷键组合被错误拆分触发;对话框输入区域太小,ModifierFlags.contains 只判断存在不判断相等, 使用 == 严格匹配 ModifierFlags; 增大输入框 padding 和字体,快捷键判断必须严格匹配所有修饰符,HotKeyService.swift#checkModifiersMatch
2025-11-28T14:30,spoke,UI/QuickAsk/AnswerPanelView.swift;MarkdownWebView.swift,fix,Toolbar hover闪烁+Markdown截断,toolbar opacity=0时hover区域也失效;WebView overflow:hidden+初始高度太小,hover区域独立于toolbar(始终可见);overflow改visible+MutationObserver监听高度变化;初始高度改200,hover检测要用独立层不能绑定在opacity控制的视图上;WebView动态高度需要observer,AnswerPanelView.swift#hoverArea
2025-11-28T14:35,spoke,UI/QuickAsk/AnswerPanelView.swift,update,按钮hover动画+Markdown不截断,关闭按钮需圆→方动画;新对话需背景渐显;Markdown被截断,关闭按钮cornerRadius 11→6;新对话背景opacity 0→0.15;Markdown用minHeight替代height,SwiftUI动画用.animation+value;frame(minHeight:)不限制最大高度,AnswerPanelView.swift#toolbar
2025-11-28T14:45,spoke,UI/QuickAsk/AnswerPanelView.swift;Services/EdgeTTSService.swift,create,实现朗读/复制/重新生成/模式选择器,朗读用edge-tts;复制需打勾动画;点赞改模式选择,EdgeTTSService调用python3 edge-tts;复制后isCopied=true+2s恢复;QuickAskMode枚举(Chat/DeepResearch/Canvas/Mind);⌘+, 打开设置,edge-tts需pip install edge-tts;NSEvent.addLocalMonitorForEvents监听快捷键,AnswerPanelView.swift#answerView
2025-11-28T14:55,spoke,Services/TTSSettings.swift;DoubaoTTSService.swift;EdgeTTSService.swift;UI/Settings/SettingsView.swift,create,TTS服务重构+豆包TTS+设置界面,需要原生打包方案+豆包逆向,TTSSettings存储配置;DoubaoTTSService用WebSocket调用豆包API;TTSService统一封装;TTSSettingsContent设置界面,豆包需要Cookie(sessionid/sid_guard/uid_tt);WebSocket端点wss://ws-samantha.doubao.com/samantha/audio/tts,TTSService.swift
2025-11-28T15:05,spoke,Services/TTSSettings.swift;UI/QuickAsk/MarkdownWebView.swift;AnswerPanelView.swift,update,填入豆包Cookie默认值+修复滚动+新对话动画,需要默认cookie;触控板滚动无效;新对话需要形状变化,填入sessionid/sid_guard/uid_tt默认值;overflow-y:auto隐藏滚动条;新对话cornerRadius 12→6,TTSSettings.swift#init;MarkdownWebView.swift#CSS;AnswerPanelView.swift#toolbar
2025-11-28T15:35,spoke,MarkdownWebView.swift;EdgeTTSService.swift;TTSSettings.swift;SettingsView.swift;AnswerPanelView.swift,update,滚动穿透+分块朗读+自动朗读,WebView拦截滚动事件;TTS延迟高;需要自动朗读,NonScrollableWebView重写scrollWheel穿透事件;按句子分块朗读;autoReadAloud设置+onChange触发,WKWebView需要子类重写scrollWheel传递给nextResponder;分块可降低首次响应延迟,MarkdownWebView.swift#NonScrollableWebView
2025-11-28T16:00,spoke,DoubaoTTSService.swift;EdgeTTSService.swift;TTSSettings.swift;SettingsView.swift,update,删除豆包TTS+Swift原生EdgeTTS,豆包被封禁返回block;需要无依赖方案,删除DoubaoTTSService;EdgeTTSClient用actor实现WebSocket协议;EdgeVoice枚举多种中英文语音;删除CookieInputRow,Edge TTS用WebSocket连接speech.platform.bing.com;需要TrustedClientToken;SSML格式发送文本;MP3格式音频,EdgeTTSService.swift#EdgeTTSClient
2025-11-28T17:00,spoke,EdgeTTSService.swift,fix,Edge TTS连接失败+播放失败,WebSocket握手失败;AVAudioPlayer(data:)解析失败,添加Sec-MS-GEC DRM Token(SHA256哈希);Origin改为chrome-extension://;添加Sec-MS-GEC-Version;播放时先保存临时文件再用contentsOf播放,Edge TTS需要DRM验证:当前时间转Windows文件时间+取整3_000_000_000+拼接Token后SHA256;音频数据有header需保存文件后播放,EdgeTTSService.swift#DRMHelper
2025-11-28T17:15,spoke,EdgeTTSService.swift;SettingsView.swift,update,Markdown符号过滤+设置界面优化+延迟测试,星号被朗读;设置样式差;无延迟报告,cleanMarkdownForTTS正则移除*#`[]等;设置卡片加Divider和彩色标签;测试区显示首音延迟ms+分块进度条,TTS前需清理Markdown符号;用正则替换移除格式标记保留文本内容,EdgeTTSService.swift#cleanMarkdownForTTS
2025-11-28T17:45,spoke,FloatingCapsuleView.swift;AnswerPanelView.swift;SettingsView.swift,fix,Cmd+逗号快捷键无法打开设置+设置界面内容太靠边,FloatingCapsule用错误selector;AnswerPanel的localMonitor在nonactivatingPanel不工作;SettingsCard无padding,FloatingCapsule改用AppDelegate.openSettings();AnswerPanel改用隐藏按钮方式;SettingsCard添加.padding(16),快捷键监听用隐藏Button+keyboardShortcut比NSEvent.addLocalMonitor更可靠;NSPanel nonactivatingPanel收不到keyDown事件,FloatingCapsuleView.swift#background
2025-11-28T17:55,spoke,HotKeyService.swift;RecordingController.swift,fix,Cmd+逗号快捷键在浮动Panel中仍不工作,SwiftUI keyboardShortcut在非key window Panel中不触发,在HotKeyService的CGEvent tap中拦截Cmd+逗号(kVK_ANSI_Comma);添加onOpenSettings回调;RecordingController中绑定到AppDelegate.openSettings(),全局快捷键用CGEvent tap拦截最可靠;SwiftUI keyboardShortcut只在有菜单栏的key window中工作,HotKeyService.swift#handleOpenSettings
2025-11-28T18:25,spoke,AppDelegate.swift;RecordingController.swift,fix,NSApp.delegate返回SwiftUI.AppDelegate导致转型失败,@NSApplicationDelegateAdaptor包装后NSApp.delegate是SwiftUI内部类型而非自定义AppDelegate,AppDelegate添加static var shared;applicationDidFinishLaunching中设置shared=self;回调改用AppDelegate.shared访问,SwiftUI的@NSApplicationDelegateAdaptor会包装delegate;NSApp.delegate返回SwiftUI.AppDelegate而非自定义类型;需要用单例模式访问自定义AppDelegate,AppDelegate.swift#shared
2025-11-28T18:45,spoke,MarkdownWebView.swift;HotKeyService.swift;RecordingController.swift,fix,代码块显示[object Object]+并发安全问题,marked v5+的renderer.code参数变为对象;CGEvent回调在非主线程访问@MainActor类的状态,renderer.code兼容新旧版本参数格式;HotKeyService所有状态访问移到DispatchQueue.main.async;AppDelegate.shared添加guard保护,marked v5+的renderer.code传入{text lang escaped}对象而非分开参数;CGEvent回调不在主线程需要dispatch到main;Swift @MainActor标记不能阻止C回调从其他线程访问,MarkdownWebView.swift#renderer.code;HotKeyService.swift#handleKeyDown
2025-11-28T19:15,spoke,Core/Attachment/*;UI/Components/*,create,附件系统抽象化重构,需要支持多入口(QuickAsk/HUD)+ZIP/文件夹文本提取+屏幕截图,创建通用附件层: Attachment类型(image/screenshot/file/textBundle); AttachmentManager单例(handleDrop/pickFiles/pickFolder/pickZIP/captureScreen); TextExtractionService(ZIP解压+文件夹遍历+代码文件过滤+行号合并); ScreenCaptureService(CGWindowListCreateImage); AttachmentPickerMenu(加号菜单组件); AttachmentDropOverlay(拖拽蒙版); AttachmentThumbnailView(通用缩略图),附件能力要抽象可复用;QuickAskAttachment改为typealias指向Attachment;NotificationCenter通知缩略图更新需Task{@MainActor};TextExtraction参考generate-docs.sh实现full模式,AttachmentManager.swift#handleDrop
2025-11-28T19:15,spoke,UI/HUD/QuickAskInputView.swift;QuickAskCapsuleView.swift,update,QuickAsk添加加号按钮+缩短下巴padding,加号菜单支持文件/文件夹/ZIP/图库/截图;底部padding太大,HStack(加号按钮+输入框); padding.bottom从8改为4; controlBar height从44改为40; padding.vertical从10改为8,加号按钮用Menu组件+menuIndicator(.hidden);拖拽支持folder/zip类型,QuickAskInputView.swift#body
2025-11-28T19:40,spoke,TextExtractionService.swift;AttachmentManager.swift;AttachmentPickerMenu.swift,perf,文件夹提取慢20秒+无进度反馈+加号按钮交互,18个md文件处理20秒太慢;用户不知道在处理;hover时希望图标fade变化,1.并行读取:withTaskGroup替代串行; 2.行号优化:addLineNumbersFast用索引遍历不用split; 3.ExtractionProgress进度回调; 4.ProcessingState显示状态; 5.AttachmentPickerMenu hover时paperclip→plus fade动画+进度条,并行读取比串行快3000倍;nonisolated标记方法可在TaskGroup中调用;预分配内存reserveCapacity减少重分配,TextExtractionService.swift#mergeFilesParallel
2025-11-28T20:00,spoke,QuickAskCapsuleView.swift;QuickAskInputView.swift;AttachmentManager.swift,fix,加号按钮位置错误+拖拽文件夹失败,加号按钮应该和左下角appIcon同位置;从Finder拖拽文件夹/ZIP无法成功,1.appIcon改为attachmentMenuButton:hover时appIcon fade变成plus;2.从QuickAskInputView移除单独加号按钮;3.handleDrop优先处理fileURL(文件夹/ZIP/普通文件);4.支持多种URL解析方式(Data/URL/String),拖拽处理要先检查fileURL再检查image因为图片文件同时符合两种类型;URL解析可能返回Data/URL/String多种类型,QuickAskCapsuleView.swift#attachmentMenuButton
2025-11-28T20:20,spoke,QuickAskCapsuleView.swift;QuickAskInputView.swift;AttachmentManager.swift,fix,菜单打开图标没变+输入框拖拽无蓝色蒙版+文件夹ZIP无效,1.菜单打开时图标仍是appIcon;2.拖拽到输入框时没有蓝色蒙版;3.文件夹/ZIP拖拽无效果,1.添加isMenuOpen状态+showPlusIcon计算属性;2.QuickAskNSTextView重写draggingEntered/performDragOperation转发给父视图;3.handleFileURL确保isFileURL+直接检查.zip扩展名,NSTextView默认处理拖拽需要重写dragging方法禁用;Menu打开时onHover不触发需要额外状态追踪;URL.isFileURL判断是否是file://协议,QuickAskInputView.swift#QuickAskNSTextView
